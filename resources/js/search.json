[[{"l":"Plugin Ecoindex pour Lighthouse","p":["npm GitHub License"]},{"l":"Introduction","p":["Ce plugin ajoute EcoIndex® à Lighthouse®."]},{"i":"il-permet-dobtenir-","l":"Il permet d'obtenir :","p":["Les mesures d'impact environnementale multicritères de votre site ;","Une évalation de la mise en oeuvre des bonnes pratiques du Green IT ;"]},{"i":"en-générant-","l":"En générant :","p":["Des rapports HTML, JSON ou la Déclaration Environnementale de votre site – Environmental Impact Statement (EIS) – de GreenIT.fr®","Ajouter ces résultats dans votre CI/CD ou un à serveur Lighthouse."]},{"i":"il-peut-être-utilisé-de-trois-manières-différentes-","l":"Il peut être utilisé de trois manières différentes :","p":["En ligne de commande npx lighthouse-ecoindex command options avec le cli fourni par le plugin ;","Avec Lighthouse cli npm lighthouse url options.","Avec Lighthouse CI;"]},{"i":"en-respectant-des-contraintes-permettant-","l":"En respectant des contraintes permettant :","p":["D'avoir des mesures réalistes et où les éléments des pages sont chargés (images, scripts, polices, etc.) ;","D'avoir des mesures normalisées entre chaque exécution ;","D'obtenir des mesures comparables entre les sites."]},{"i":"les-contraintes--process-reproductible-","l":"Les contraintes / process reproductible :","p":["Lancez un navigateur Chrome sans tête avec les capacités no-sandbox, disable-dev-shm-usage et goog:loggingPrefs définies sur {\"performance\" : \"ALL\"}.","Ouvrez la page sans données locales (cache, cookies, localstorage...) à une résolution de 1920 × 1080px.","Attendez 3 secondes","Faites défiler la page jusqu'en bas","Attendez encore 3 secondes","Fermer la page","Lors de la mesure d'un parcours utilisateur, le cache est vide au début du parcours, mais est conservé et réutilisé tout au long du parcours, si il est mise en place par le site (Bonne pratique)."]},{"l":"Récapitulatif des fonctionnalités","p":["client interne npx lighthouse-ecoindex command options;","client Lighthouse npm lighthouse url options;","Lighthouse CI","Fonctionnalités","cli(int)","cli(lh)","CI","Rapports Lighthouse avec les audits ecoindex","✅","Bonnes pratiques Green IT","Déclaration Environnementale (EIS)","❌","Publication des données d'audits à un serveur Lighthouse"]},{"l":"Documentation des usages","p":["lighthouse-ecoindex CLI Lighthouse CLI Lighthouse CI","Details of plugin results"]}],[{"i":"que-mesure-lighthouse-ecoindex-","l":"Que mesure lighthouse-ecoindex ?","p":["Le plugin lighthouse-ecoindex mesure les critères suivants :","Le nombres d'élements HTML (DOM) ;","Le nombre de requêtes HTTP ;","Le poids total des ressources téléchargées.","On peut donc en déduire :","Un score EcoIndex®, noté de 0 à 100 ;","Une note EcoIndex®, noté de A à E ;","Les émissions de CO2 ;","La consommation d'eau.","Comment fonctionne l'écoindex ?","Ce sont les informations principales que l'on retrouve sur la page de résultat de l'audit.","Vous y retrouverez également un tableau de synthèse des résultats des audits Lighthouse et EcoIndex® : les audits correspondants aux bonnes pratiques."]}],[{"l":"Utilisation de lighthouse-ecoindex"},{"l":"Objectifs","p":["Cet utilitaire en ligne de commande (cli) permet, au travers de Lighthouse, d'obtenir des rapports d'audits Green IT de votre site web. Cela pour :","des parcours (1 parcours = 1 liste d'URL) via un fichier JSON ;","une liste d'URLs ;","une URL unique.","En respectant des contraintes permettant d'avoir des mesures réalistes et où les éléments des pages sont chargés (images, scripts, polices, etc.), normalisées entre chaque exécution et comparables entre les sites Voir les explications.","A la sortie, vous obtiendrez :","Des rapports d'audits Lighthouse avec les audits EcoIndex et les bonnes pratiques, au format HTML et/ou JSON ;","Une Déclaration Environnementale de votre site – Environmental Impact Statement (EIS) – de GreenIT.fr® au format JSON, HTML et Markdown."]},{"l":"Installation","p":["Il n'est pas nécessaire d'installer le plugin lighthouse-plugin-ecoindex pour l'utiliser. Il est possible de l'utiliser directement avec npx."]},{"l":"Utilisation","p":["Commandes disponibles :","npx lighthouse-ecoindex collect options","Sert à lancer la collecte des audits Lighthouse et EcoIndex suivant les options passées en paramètres.","npx lighthouse-ecoindex convert options","Sert à générer la Déclaration Environnementale de votre site – Environmental Impact Statement (EIS) – de GreenIT.fr® au format JSON, HTML et Markdown, si elle n'a pas été générée lors de la collecte."]},{"l":"command collect","p":["npx lighthouse-ecoindex collect options","Sert à lancer la collecte des audits Lighthouse et EcoIndex suivant les options passées en paramètres."]},{"l":"Options","p":["-d, --demo: Utilise les un fichier de démonstration (voir plus bas).","-u, --url: URL à auditer, supporte plusieurs valeurs.","-j, --json-file: Fichier structuré, doit respecter un schéma (voir plus bas).","-h, --extra-header: Objet de configuration supplémentaire pour Lighthouse. Chaîne JSON ou chemin vers un fichier JSON.","-p, --output-path: Dossier de sortie.","-o, --output: Rapporteur pour les résultats, supporte plusieurs valeurs. Choix : \"json\", \"html\", \"statement\". ATTENTION : \"csv\" n'est pas disponible.","-a, --audit-category: Audit à exécuter, supporte plusieurs valeurs.","--help: Affiche l'aide."]},{"l":"Fichier de configuration JSON","p":["Le format du fichier doit être respecté !"]},{"l":"Modèle de fichier JSON"},{"l":"Exemples","p":["Génère un rapport avec le fichier de démonstration.","Génère des plusieurs rapports pour de multiples parcours.","Génère un rapport pour une URL."]},{"l":"command convert","p":["npx lighthouse-ecoindex convert options","Sert à générer la Déclaration Environnementale de votre site – Environmental Impact Statement (EIS) – de GreenIT.fr® au format JSON, HTML et Markdown, si elle n'a pas été générée lors de la collecte."]},{"i":"options-1","l":"Options","p":["-i, --input-report: Fichier JSON généré par lighthouse-ecoindex.","-p, --output-path: Dossier de sortie.","--help: Affiche l'aide."]},{"i":"exemples-1","l":"Exemples","p":["Convertir le(s) rapport(s) JSON généré(s) par lighthouse-ecoindex en fichier de déclaration environnementale."]}],[{"l":"Utilisation avec lighthouse CLI"},{"l":"Documentation externe des dépendances","p":["lighthouse CLI","Puppeteer"]},{"l":"Objectifs","p":["Utiliser le plugin lighthouse-ecoindex avec le client Lighthouse CLI."]},{"l":"Installation","p":["Vous devez utiliser les fichiers de configuration de Lighthouse (exemple ci-dessous) et Puppeteer (présent dans le plugin) pour pouvoir utiliser le plugin lighthouse-ecoindex."]},{"l":"Utilisation","p":["Vous devez utiliser le fichiers configuration de Lighthouse pour pouvoir utiliser le plugin lighthouse-ecoindex.","Télécharger","Placer le fichier .lighthouserc.js à la racine de votre projet suffit, il n'est pas forcement nécessaire de l'appeler dans la commande.","Le fichier de configuration Puppeteer est indiqué dans puppeteerScript du fichier. Si besoin, adapter le chemin.","Ne modifier pas le fichier Puppeteer sauf si vous devez ajouter des actions spécifiques (ex. Fermeture de popin pour validation de cookies). Conserver le process en place pour avoir des mesures normalisée. Voir les explications"]},{"l":"Modèle de fichier de configuration de Lighthouse"},{"l":"Modèle de fichier de configuration de Puppeteer"},{"l":"Exemples","p":["Lancer la mesure sur une URL :"]}],[{"l":"Utilisation avec Lighthouse CI"},{"l":"Documentation externe des dépendances","p":["Lighthouse CI","Puppeteer"]},{"l":"Objectifs","p":["Utiliser le plugin lighthouse-ecoindex avec Lighthouse CI dans vos outils de CI/CD ou vos repositories CI/Cd.","Vous pourrez ainsi :","Publier les résultats des audits Lighthouse et EcoIndex® dans votre CI/CD ;","Publier les résultats des audits Lighthouse et EcoIndex® dans un serveur Lighthouse."]},{"l":"Installation","p":["Vous devez utiliser les fichiers de configuration de Lighthouse (exemple ci-dessous) et Puppeteer (présent dans le plugin) pour pouvoir utiliser le plugin lighthouse-ecoindex."]},{"l":"Utilisation","p":["Vous devez utiliser le fichiers configuration de Lighthouse pour pouvoir utiliser le plugin lighthouse-ecoindex.","Télécharger","Placer le fichier .lighthouserc.js à la racine de votre projet.","Le fichier de configuration Puppeteer est indiqué dans puppeteerScript du fichier. Si besoin, adapter le chemin.","Ne modifier pas le fichier Puppeteer sauf si vous devez ajouter des actions spécifiques (ex. Fermeture de popin pour validation de cookies). Conserver le process en place pour avoir des mesures normalisée. Voir les explications"]},{"l":"Modèle de fichier de configuration de Lighthouse"},{"l":"Modèle de fichier de configuration de Puppeteer"},{"l":"Exemples","p":[".github/workflows/ci.yml",".gitlab-ci.yml",".circleci/config.yml","machine-setup.sh","job.sh"]}],[{"l":"Les audits du plugin","p":["Les bonnes pratiques proposées comme audits dans le plugin Ecoindex Lighthouse","Pour être ajoutées comme audits, les bonnes pratiques doivent être mesurables et quantifiables.","Les « 115 bonnes pratiques » du Collectif GreenIT Référentiel général d'écoconception de services numériques (RGESN)"]},{"i":"autres-audits--bonnes-pratiques","l":"Autres Audits / Bonnes pratiques","p":["Vérifier si le site fonctionne à l'énergie verte avec thegreenwebfoundation.org/api https://api.thegreenwebfoundation.org/api/v3/greencheck/${domaine}","D'autres seront ajoutés ultérieurement."]}],[{"i":"rweb---les--115-bonnes-pratiques--du-collectif-greenit","l":"#RWEB - Les « 115 bonnes pratiques » du Collectif GreenIT","p":["Listes des bonnes pratiques GreenIT opposables, présentent dans l'outil GreenIT analysis.","Les 115 bonnes pratiques"]},{"l":"Liste des bonnes pratiques GreenIT","p":["Ajouter des en-têtes expires ou cache-control","Compresser les ressources (>= 95%)","Éviter les erreurs de requête HTTP","Éviter les redirections","Externaliser css et js","Fournir une feuille de style pour l'impression (test : https://www.creastuces.com/des-styles-css-pour-optimiser-limpression-papier/)","Limiter le nombre de domaines (<6)","Limiter le nombre de requêtes HTTP (<27)","Limiter les fichiers de feuilles de style (<=10)","Longueur maximale des cookies (<512 octets)","Minification des css et js","Ne pas redimensionner l'image dans le navigateur","Ne pas télécharger d'images inutiles","Ne pas utiliser de bouton social standard","Ne pas utiliser de plugins","Optimiser les images bitmap","Optimiser les images svg","Pas de cookie pour les ressources statiques","Utiliser des polices de caractères standard","Utiliser HTTP/2 au lieu de HTTP/1","Valider les js"]}],[{"i":"référentiel-général-décoconception-de-services-numériques-rgesn","l":"Référentiel général d'écoconception de services numériques (RGESN)","p":["Référentiel RGESN"]},{"i":"liste-partielle-des-critères-rgesn","l":"Liste (partielle) des critères RGESN","p":["4.1 Le service numérique est-il utilisable via une connexion bas débit ?","4.10 Le service numérique utilise-t-il majoritairement des polices de caractères du système d'exploitation ?","6.1 Le service numérique s'astreint-il à un poids maximum par écran ?","6.2 Le service numérique s'astreint-il à une limite de requêtes par écran ?","6.3 Le service numérique utilise-t-il des mécanismes de mises en cache pour la totalité des contenus transférés dont il a le contrôle ?","6.4 Le service numérique a-t-il mis en place des techniques de compression sur la totalité des ressources transférées dont il a le contrôle ?","6.5 Le service numérique affiche-t-il majoritairement des éléments graphiques et des médias dont les dimensions d'origine correspondent aux dimensions du contexte d'affichage ?","6.6 Le service numérique propose-t-il un mécanisme de chargement progressif pour les éléments graphiques et les médias le nécessitant ?","6.9 Le service numérique utilise-t-il un stockage côté client de certaines ressources afin d'éviter des échanges réseaux inutiles ?","7.1 Le service numérique a-t-il recours à un système de cache serveur pour les données les plus utilisées ?","7.2 Le service numérique est-il configuré pour transmettre depuis le serveur des contenus compressés au client qui les accepte ?","8.1 Le service numérique utilise-t-il un hébergement signataire du Code de Conduite européen sur les Datacentres ?","8.2 Le service numérique utilise-t-il un hébergement ayant une démarche de réduction de son impact écologique ?","8.3 Le service numérique utilise-t-il un hébergement qui fournit une politique de gestion durable des équipements ?","8.4 Le service numérique utilise-t-il un hébergement qui fournit des indicateurs d'impacts environnementaux liés à son activité ?","8.5 Le service numérique utilise-t-il un hébergement dont le PUE (Power Usage Effectiveness) est communiqué ?","8.6 Le service numérique utilise-t-il un hébergement dont son WUE (Water Usage Effectiveness) est communiqué ?","8.7 Le service numérique utilise-t-il un hébergement dont la consommation d'électricité est majoritairement d'origine renouvelable ?","Liste des critères du RGESN possiblement mesurables avec lighthouse-ecoindex"]},{"l":"RGESN v1","p":["Référentiel RGESN à télécharger (data.gouv)","https://www.data.gouv.fr/fr/datasets/r/d76e723d-543b-400d-95d3-3c7bcc2187c1"]}],[{"l":"Contribuer à ce projet","p":["Ils restent encore beaucoup de choses à faire pour améliorer ce projet. Vous pouvez nous aider en contribuant à ce projet."]},{"i":"comment-contribuer-","l":"Comment contribuer ?","p":["Vous pouvez contribuer de différentes manières :","En ouvrant une issue","En proposant une pull request"]},{"i":"comment-installer-le-projet-en-local-","l":"Comment installer le projet en local ?","p":["L'usage du devcontainer n'est pas obligatoire pour le développement.","Un devcontainers à été mis en place pour faciliter le développement. Il suffit d'installer Docker et Visual Studio Code et de suivre les étapes suivantes :","Cloner le projet","Ouvrir le projet dans Visual Studio Code","Ouvrir le dossier .devcontainer et cliquer sur le bouton Reopen in Container","Ouvrir un terminal et lancer la commande npm install","Consulter les sous-dossiers de examples pour voir les exemples d'utilisation et suivre les README.md pour les lancer.","Ce devcontainer contient notamment un serveur Lighthouse pour tester le plugin en mode"]},{"l":"Lighthouse server","p":["En mode devcontainer connectez-vous au container Docker via sa ligne de commande et faites lhci wizard pour configurer le serveur Lighthouse. Reportez cette configuration dans le fichier .lighthouserc.js à la racine du projet.","Sans devcontainer vous pouvez installer le serveur Lighthouse en suivant la documentation officielle"]},{"i":"point-dattention","l":"Point d'attention"},{"l":"Contraintes de développement","p":["Les gatherers custom ne peuvent pas être utilisés avec Lighthouse CI. Il faut donc trouver une autre solution pour les audits. De nombreux gatherers sont déjà disponibles dans Lighthouse, il faut donc les utiliser."]},{"l":"Liste des tâches","p":["Plugin;","npx-example;","test lighthouse-ci;","test lightouse CLI;","test (local);","Ajouter des audits ;","Continuer à documenter le projet ;","Valider les Good and Poor thresholds voir [lighthouse-plugin-ecoindex/utils/index.js#getMetricRange()] ;","Ajouter des bonnes pratiques ;","Localiser le plugin i18n ;","Ajouter des tests unitaires ;","..."]},{"i":"sources-daides-et-dinspirations","l":"Sources d'aides et d'inspirations","p":["https://github.com/GoogleChrome/lighthouse/blob/main/docs/user-flows.md","https://engineering.q42.nl/making-a-lighthouse-plugin-work-with-lighthouse-ci/","https://github.com/googleads/publisher-ads-lighthouse-plugin"]}],[{"l":"A propos de ce projet","p":["Une contribution de l'association GreenIT.fr à la communauté de l'écoconception."]}]]